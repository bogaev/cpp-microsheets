# üìã microSheets

**microSheets** ‚Äî —Ä–µ–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ç–∏–ø–∞ Google Sheets –Ω–∞ —è–∑—ã–∫–µ C++.
–¢–∞–±–ª–∏—Ü–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –∏ –≤—ã–≤–æ–¥ —á–∏—Å–ª–æ–≤—ã—Ö –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å—Å—ã–ª–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏–µ —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π –∏ —Ñ–∞–π–ª–æ–≤—ã–π –≤–≤–æ–¥/–≤—ã–≤–æ–¥.

## ‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- C++17 standard
- STL [^1]
- Cmake [^2] minimum version: 3.7
- Java 11 [^3]
- ANTLR [^4]

## üõ†Ô∏è –°–±–æ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ Ubuntu

### <img src="https://www.svgrepo.com/download/184143/java.svg" alt="java" width="30"/> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Java

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java 11 —Å –ø–æ–º–æ—â—å—é apt

	```
	sudo apt update
	sudo apt install openjdk-11-jdk
	java -version
	```

- –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è 11:

	```
	openjdk version "11.0.19" 2023-04-18
	OpenJDK Runtime Environment (build 11.0.19+7-post-Ubuntu-0ubuntu122.04.1)
	OpenJDK 64-Bit Server VM (build 11.0.19+7-post-Ubuntu-0ubuntu122.04.1, mixed mode, sharing)
	```

- –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π Java, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ```update-alternatives``` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏

	```
	sudo update-alternatives --config java
	```

### <img src="https://avatars.githubusercontent.com/u/80584?s=200&v=4" alt="java" width="30"/> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ANTLR

- –ü–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ```../thirdparty/antlr/antlr-4.13.0-complete.jar``` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ C++-–∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ —è–∑—ã–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ –æ–ø–∏—Å–∞–Ω–∏—è ```Formula.g4```
- –ù–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ runtime-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ANTLR –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –∑–∞–≤–∏—Å—è—Ç –∫–ª–∞—Å—Å—ã –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ —è–∑—ã–∫–∞
- –û–±–∞ —ç—Ç–∞–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é cmake –∏ –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å ANTLR –≤—Ä—É—á–Ω—É—é (—Å–º. —Å–ª–µ–¥—É—é—â–∏–π –ø—É–Ω–∫—Ç)

### <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Cmake.svg/1200px-Cmake.svg.png" alt="java" width="30"/> –°–±–æ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é Cmake

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ cmake

	```
	sudo apt install cmake
	```

- –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ spreadsheet —Å –ø–æ–º–æ—â—å—é cmake –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ build:

	```
	cd [path-to-cpp-spreadsheet-main]\
	mkdir build && cd build
	cmake .. && make
	```
	‚ö†Ô∏è –°–±–æ—Ä–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ANTLR –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ microSheets

- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ```./spreadsheet``` –∫–æ–º–∞–Ω–¥—ã –≤–≤–æ–¥—è—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:

	```
	./spreadsheet
	# –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–µ —Ç–∞–±–ª–∏—Ü—ã
	> SetCell A1 2
	> SetCell A2 3                     
	# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –¥—Ä—É–≥–∏—Ö —è—á–µ–µ–∫
	> SetCell B1 =(A1*3+A2)/5-A1
	# –í—ã–≤–æ–¥ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–∏
	> GetCell B1
	-0.2
	> exit
	```

- –î–ª—è –≤—ã–≤–æ–¥–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

	```./spreadsheet --help```

- –î–ª—è –≤—ã–≤–æ–¥–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

	```./spreadsheet --test```

- –î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ —Ä–µ–∂–∏–º–µ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª (—Å–º. –ø—Ä–∏–º–µ—Ä –¥–∞–ª–µ–µ):

	```./spreadsheet [input_filepath] [output_filepath]```

## üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä

- –ü–æ–ª—É—á–∏–º –≤—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –∫–æ–º–∞–Ω–¥ (—Ñ–∞–π–ª [input](input)):

	```
	# –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —è—á–µ–π–∫–∞–º
	SetCell A1 1
	# –Ø—á–µ–π–∫–∏ –º–æ–≥—É—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞
	SetCell E2 =A1
	SetCell E4 =E2
	# –ó–Ω–∞—á–µ–Ω–∏–µ —è—á–µ–µ–∫ E2 –∏ E4 –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–≤–Ω–æ –∑–Ω–∞—á–µ–Ω–∏—é —è—á–µ–π–∫–∏ A1, —Ç.–µ. 1
	GetCell E4
	# –ò–∑–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π —è—á–µ–π–∫–∏ —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è
	SetCell A1 =(2+2)*3/4
	# –ò –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º—ã—Ö —è—á–µ–µ–∫ —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
	GetCell A1
	GetCell E2
	GetCell E4
	# –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —Ä–∞–∑—Ä–µ—à–∏—Ç –¥–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É, —Ç.–∫. –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π
	SetCell A1 =E4
	# –ó–Ω–∞—á–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
	GetCell E4
	# –¢–µ—Å—Ç –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
	SetCell A1 "Meow"
	SetCell E2 "Woof"
	GetCell A1
	GetCell E2
	```

- –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å –≤—ã–≤–æ–¥–æ–º –≤ —Ñ–∞–π–ª ```output```:

	```./spreadsheet input output```

- –í—ã–≤–æ–¥ (—Ñ–∞–π–ª ```output```):

	```
	1
	2
	3
	3
	3
	Error setting cell value: Found circular dependency!
	3
	"Meow"
	"Woof"
	```
	
<!--
## –ü—Ä–∏–º–µ—Ä—ã
-->

[^1]: https://en.wikipedia.org/wiki/Standard_Template_Library
[^2]: https://cmake.org/download/
[^3]: https://www.java.com/en/download/
[^4]: https://www.antlr.org/download.html